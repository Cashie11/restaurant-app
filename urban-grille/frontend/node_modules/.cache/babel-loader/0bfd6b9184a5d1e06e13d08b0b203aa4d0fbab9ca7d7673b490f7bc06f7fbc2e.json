{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect,useCallback}from'react';import{cartService}from'../services/cartService';import{useAuth}from'./AuthContext';import{jsx as _jsx}from\"react/jsx-runtime\";const CartContext=/*#__PURE__*/createContext(undefined);export const CartProvider=_ref=>{let{children}=_ref;const[cart,setCart]=useState(null);const[loading,setLoading]=useState(false);const{user}=useAuth();const refreshCart=useCallback(async()=>{if(!user){setCart(null);return;}try{setLoading(true);const cartData=await cartService.getCart();setCart(cartData);}catch(error){console.error('Failed to fetch cart:',error);}finally{setLoading(false);}},[user]);const addToCart=async function(productId){let quantity=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;try{setLoading(true);await cartService.addToCart(productId,quantity);await refreshCart();}catch(error){console.error('Failed to add to cart:',error);throw error;}finally{setLoading(false);}};const updateQuantity=async(itemId,quantity)=>{try{setLoading(true);await cartService.updateCartItem(itemId,quantity);await refreshCart();}catch(error){console.error('Failed to update cart item:',error);throw error;}finally{setLoading(false);}};const removeItem=async itemId=>{try{setLoading(true);await cartService.removeFromCart(itemId);await refreshCart();}catch(error){console.error('Failed to remove cart item:',error);throw error;}finally{setLoading(false);}};const clearCart=async()=>{try{setLoading(true);await cartService.clearCart();await refreshCart();}catch(error){console.error('Failed to clear cart:',error);throw error;}finally{setLoading(false);}};// Load cart when user logs in\nuseEffect(()=>{if(user){refreshCart();}else{setCart(null);}},[user,refreshCart]);return/*#__PURE__*/_jsx(CartContext.Provider,{value:{cart,loading,addToCart,updateQuantity,removeItem,clearCart,refreshCart},children:children});};export const useCart=()=>{const context=useContext(CartContext);if(context===undefined){throw new Error('useCart must be used within a CartProvider');}return context;};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","useCallback","cartService","useAuth","jsx","_jsx","CartContext","undefined","CartProvider","_ref","children","cart","setCart","loading","setLoading","user","refreshCart","cartData","getCart","error","console","addToCart","productId","quantity","arguments","length","updateQuantity","itemId","updateCartItem","removeItem","removeFromCart","clearCart","Provider","value","useCart","context","Error"],"sources":["/home/cyber/Desktop/Bot/team1/urban-grille/frontend/src/context/CartContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect, ReactNode, useCallback } from 'react';\nimport { cartService, Cart } from '../services/cartService';\nimport { useAuth } from './AuthContext';\n\ninterface CartContextType {\n    cart: Cart | null;\n    loading: boolean;\n    addToCart: (productId: number, quantity?: number) => Promise<void>;\n    updateQuantity: (itemId: number, quantity: number) => Promise<void>;\n    removeItem: (itemId: number) => Promise<void>;\n    clearCart: () => Promise<void>;\n    refreshCart: () => Promise<void>;\n}\n\nconst CartContext = createContext<CartContextType | undefined>(undefined);\n\nexport const CartProvider: React.FC<{ children: ReactNode }> = ({ children }) => {\n    const [cart, setCart] = useState<Cart | null>(null);\n    const [loading, setLoading] = useState(false);\n    const { user } = useAuth();\n\n    const refreshCart = useCallback(async () => {\n        if (!user) {\n            setCart(null);\n            return;\n        }\n\n        try {\n            setLoading(true);\n            const cartData = await cartService.getCart();\n            setCart(cartData);\n        } catch (error) {\n            console.error('Failed to fetch cart:', error);\n        } finally {\n            setLoading(false);\n        }\n    }, [user]);\n\n    const addToCart = async (productId: number, quantity: number = 1) => {\n        try {\n            setLoading(true);\n            await cartService.addToCart(productId, quantity);\n            await refreshCart();\n        } catch (error) {\n            console.error('Failed to add to cart:', error);\n            throw error;\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const updateQuantity = async (itemId: number, quantity: number) => {\n        try {\n            setLoading(true);\n            await cartService.updateCartItem(itemId, quantity);\n            await refreshCart();\n        } catch (error) {\n            console.error('Failed to update cart item:', error);\n            throw error;\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const removeItem = async (itemId: number) => {\n        try {\n            setLoading(true);\n            await cartService.removeFromCart(itemId);\n            await refreshCart();\n        } catch (error) {\n            console.error('Failed to remove cart item:', error);\n            throw error;\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const clearCart = async () => {\n        try {\n            setLoading(true);\n            await cartService.clearCart();\n            await refreshCart();\n        } catch (error) {\n            console.error('Failed to clear cart:', error);\n            throw error;\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    // Load cart when user logs in\n    useEffect(() => {\n        if (user) {\n            refreshCart();\n        } else {\n            setCart(null);\n        }\n    }, [user, refreshCart]);\n\n    return (\n        <CartContext.Provider\n            value={{\n                cart,\n                loading,\n                addToCart,\n                updateQuantity,\n                removeItem,\n                clearCart,\n                refreshCart\n            }}\n        >\n            {children}\n        </CartContext.Provider>\n    );\n};\n\nexport const useCart = () => {\n    const context = useContext(CartContext);\n    if (context === undefined) {\n        throw new Error('useCart must be used within a CartProvider');\n    }\n    return context;\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}