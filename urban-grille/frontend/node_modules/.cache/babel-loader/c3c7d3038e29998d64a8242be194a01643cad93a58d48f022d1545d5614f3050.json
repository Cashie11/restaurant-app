{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import api from'../api/axios';// Types\nimport{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(undefined);export const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[isLoading,setIsLoading]=useState(true);// Check for existing token on mount\nuseEffect(()=>{const checkAuth=async()=>{const token=localStorage.getItem('access_token');if(token){try{const response=await api.get('/auth/me');setUser(response.data);}catch(error){console.error('Auth check failed:',error);localStorage.removeItem('access_token');localStorage.removeItem('refresh_token');}}setIsLoading(false);};checkAuth();},[]);const login=async(token,refreshToken)=>{localStorage.setItem('access_token',token);localStorage.setItem('refresh_token',refreshToken);try{const response=await api.get('/auth/me');setUser(response.data);}catch(error){console.error('Login failed:',error);throw error;}};const logout=()=>{localStorage.removeItem('access_token');localStorage.removeItem('refresh_token');setUser(null);window.location.href='/signin';};const updateUser=updatedUser=>{setUser(updatedUser);};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,isAuthenticated:!!user,isLoading,login,logout,updateUser},children:children});};export const useAuth=()=>{const context=useContext(AuthContext);if(context===undefined){throw new Error('useAuth must be used within an AuthProvider');}return context;};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","api","jsx","_jsx","AuthContext","undefined","AuthProvider","_ref","children","user","setUser","isLoading","setIsLoading","checkAuth","token","localStorage","getItem","response","get","data","error","console","removeItem","login","refreshToken","setItem","logout","window","location","href","updateUser","updatedUser","Provider","value","isAuthenticated","useAuth","context","Error"],"sources":["/home/cyber/Desktop/Bot/team1/urban-grille/frontend/src/context/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport api from '../api/axios';\n\n// Types\nimport { User } from '../types/auth';\n\ninterface AuthContextType {\n    user: User | null;\n    isAuthenticated: boolean;\n    isLoading: boolean;\n    login: (token: string, refreshToken: string) => Promise<void>;\n    logout: () => void;\n    updateUser: (user: User) => void;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport const AuthProvider: React.FC<{ children: ReactNode }> = ({ children }) => {\n    const [user, setUser] = useState<User | null>(null);\n    const [isLoading, setIsLoading] = useState(true);\n\n    // Check for existing token on mount\n    useEffect(() => {\n        const checkAuth = async () => {\n            const token = localStorage.getItem('access_token');\n            if (token) {\n                try {\n                    const response = await api.get('/auth/me');\n                    setUser(response.data);\n                } catch (error) {\n                    console.error('Auth check failed:', error);\n                    localStorage.removeItem('access_token');\n                    localStorage.removeItem('refresh_token');\n                }\n            }\n            setIsLoading(false);\n        };\n\n        checkAuth();\n    }, []);\n\n    const login = async (token: string, refreshToken: string) => {\n        localStorage.setItem('access_token', token);\n        localStorage.setItem('refresh_token', refreshToken);\n\n        try {\n            const response = await api.get('/auth/me');\n            setUser(response.data);\n        } catch (error) {\n            console.error('Login failed:', error);\n            throw error;\n        }\n    };\n\n    const logout = () => {\n        localStorage.removeItem('access_token');\n        localStorage.removeItem('refresh_token');\n        setUser(null);\n        window.location.href = '/signin';\n    };\n\n    const updateUser = (updatedUser: User) => {\n        setUser(updatedUser);\n    };\n\n    return (\n        <AuthContext.Provider value={{\n            user,\n            isAuthenticated: !!user,\n            isLoading,\n            login,\n            logout,\n            updateUser\n        }}>\n            {children}\n        </AuthContext.Provider>\n    );\n};\n\nexport const useAuth = () => {\n    const context = useContext(AuthContext);\n    if (context === undefined) {\n        throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n};\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,UAAU,CAAEC,QAAQ,CAAEC,SAAS,KAAmB,OAAO,CACxF,MAAO,CAAAC,GAAG,KAAM,cAAc,CAE9B;AAAA,OAAAC,GAAA,IAAAC,IAAA,yBAYA,KAAM,CAAAC,WAAW,cAAGP,aAAa,CAA8BQ,SAAS,CAAC,CAEzE,MAAO,MAAM,CAAAC,YAA+C,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACxE,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGX,QAAQ,CAAc,IAAI,CAAC,CACnD,KAAM,CAACY,SAAS,CAAEC,YAAY,CAAC,CAAGb,QAAQ,CAAC,IAAI,CAAC,CAEhD;AACAC,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAa,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC1B,KAAM,CAAAC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC,CAClD,GAAIF,KAAK,CAAE,CACP,GAAI,CACA,KAAM,CAAAG,QAAQ,CAAG,KAAM,CAAAhB,GAAG,CAACiB,GAAG,CAAC,UAAU,CAAC,CAC1CR,OAAO,CAACO,QAAQ,CAACE,IAAI,CAAC,CAC1B,CAAE,MAAOC,KAAK,CAAE,CACZC,OAAO,CAACD,KAAK,CAAC,oBAAoB,CAAEA,KAAK,CAAC,CAC1CL,YAAY,CAACO,UAAU,CAAC,cAAc,CAAC,CACvCP,YAAY,CAACO,UAAU,CAAC,eAAe,CAAC,CAC5C,CACJ,CACAV,YAAY,CAAC,KAAK,CAAC,CACvB,CAAC,CAEDC,SAAS,CAAC,CAAC,CACf,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAU,KAAK,CAAG,KAAAA,CAAOT,KAAa,CAAEU,YAAoB,GAAK,CACzDT,YAAY,CAACU,OAAO,CAAC,cAAc,CAAEX,KAAK,CAAC,CAC3CC,YAAY,CAACU,OAAO,CAAC,eAAe,CAAED,YAAY,CAAC,CAEnD,GAAI,CACA,KAAM,CAAAP,QAAQ,CAAG,KAAM,CAAAhB,GAAG,CAACiB,GAAG,CAAC,UAAU,CAAC,CAC1CR,OAAO,CAACO,QAAQ,CAACE,IAAI,CAAC,CAC1B,CAAE,MAAOC,KAAK,CAAE,CACZC,OAAO,CAACD,KAAK,CAAC,eAAe,CAAEA,KAAK,CAAC,CACrC,KAAM,CAAAA,KAAK,CACf,CACJ,CAAC,CAED,KAAM,CAAAM,MAAM,CAAGA,CAAA,GAAM,CACjBX,YAAY,CAACO,UAAU,CAAC,cAAc,CAAC,CACvCP,YAAY,CAACO,UAAU,CAAC,eAAe,CAAC,CACxCZ,OAAO,CAAC,IAAI,CAAC,CACbiB,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,SAAS,CACpC,CAAC,CAED,KAAM,CAAAC,UAAU,CAAIC,WAAiB,EAAK,CACtCrB,OAAO,CAACqB,WAAW,CAAC,CACxB,CAAC,CAED,mBACI5B,IAAA,CAACC,WAAW,CAAC4B,QAAQ,EAACC,KAAK,CAAE,CACzBxB,IAAI,CACJyB,eAAe,CAAE,CAAC,CAACzB,IAAI,CACvBE,SAAS,CACTY,KAAK,CACLG,MAAM,CACNI,UACJ,CAAE,CAAAtB,QAAA,CACGA,QAAQ,CACS,CAAC,CAE/B,CAAC,CAED,MAAO,MAAM,CAAA2B,OAAO,CAAGA,CAAA,GAAM,CACzB,KAAM,CAAAC,OAAO,CAAGtC,UAAU,CAACM,WAAW,CAAC,CACvC,GAAIgC,OAAO,GAAK/B,SAAS,CAAE,CACvB,KAAM,IAAI,CAAAgC,KAAK,CAAC,6CAA6C,CAAC,CAClE,CACA,MAAO,CAAAD,OAAO,CAClB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}